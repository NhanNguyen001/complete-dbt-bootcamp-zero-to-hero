unit_tests:
  - name: unittest_fullmoon_matcher
    description: This test checks if the full moon review matches the full moon review in the source table.
    model: mart_fullmoon_reviews
    given:
      - input: ref('fct_reviews')
        rows: 
          - {review_date: '2025-01-13'}
          - {review_date: '2025-01-14'}
          - {review_date: '2025-01-15'}
      - input: ref('seed_full_moon_dates')
        rows:
          - {full_moon_date: '2025-01-13'}
    expect:
      rows:
        - {review_date: '2025-01-13', is_full_moon: "not full moon"}
        - {review_date: '2025-01-14', is_full_moon: "full moon"}
        - {review_date: '2025-01-15', is_full_moon: "not full moon"}
